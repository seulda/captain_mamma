# 📱 선장님 오늘의 메뉴는요? - 기술 문서

## 🎯 프로젝트 개요

**프로젝트명**: 선장님 오늘의 메뉴는요?  
**플랫폼**: iOS, Android, Web (Flutter)  
**개발 언어**: Dart 3.0+  
**프레임워크**: Flutter 3.10+  
**아키텍처**: MVVM + Provider 패턴

### 📋 비즈니스 목표

- 메뉴 선택 장애 해결을 위한 위치 기반 식당 추천 서비스
- 랜덤 선택 기능으로 고민 시간 단축
- 직관적이고 간편한 사용자 경험 제공

---

## 🏗 기술 아키텍처

### **1. 전체 아키텍처**

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Presentation  │    │    Business     │    │      Data       │
│     Layer       │◄──►│     Logic       │◄──►│     Layer       │
│   (UI/Screens)  │    │   (Providers)   │    │   (Services)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
   Widget Tree              State Mgmt            External APIs
   - Screens                - Provider             - Kakao Local
   - Widgets                - ChangeNotifier       - Google Maps
   - Themes                 - Consumer             - Google Auth
```

### **2. 프로젝트 구조**

```
lib/
├── core/                          # 공통/코어 코드 (에러, 네트워크, 유틸, 공용 위젯 등)
│   ├── error/
│   ├── network/
│   ├── utils/
│   └── widgets/
├── features/                      # 각 기능(Feature)별 폴더
│   ├── map/
│   │   ├── data/                  # 데이터 계층 (datasources, models, repositories)
│   │   ├── domain/                # 도메인 계층 (entities, repositories, usecases)
│   │   └── presentation/          # 프리젠테이션 계층 (bloc, pages, widgets)
│   └── ...                        # 다른 feature도 동일 구조
├── main.dart                      # 앱 엔트리포인트
```

- 각 feature는 data/domain/presentation 3계층으로 분리
- core/에는 공통 유틸, 에러, 네트워크, 공용 위젯 등 위치
- Bloc, Freezed, Either, Repository 패턴 등 클린 아키텍처 원칙 적용

---

## 💻 기술 스택 상세

### **프론트엔드 기술**

- **Flutter 3.10+**: 크로스 플랫폼 UI 프레임워크
- **Dart 3.0+**: null safety 완전 지원
- **Material Design**: 구글 디자인 시스템 기반

### **상태 관리**

- **Provider 6.1.1**: 단순하고 효율적인 상태 관리
- **ChangeNotifier**: 상태 변경 감지 및 알림
- **Consumer/Selector**: 선택적 위젯 리빌드

### **네트워킹 & API**

- **Dio 5.4.0**: HTTP 클라이언트 (인터셉터, 에러 처리)
- **HTTP 1.1.0**: 기본 HTTP 요청 처리
- **flutter_dotenv 5.1.0**: 환경 변수 보안 관리

### **위치 서비스**

- **geolocator 10.1.0**: GPS 위치 정보 획득
- **geocoding 2.1.1**: 주소 ↔ 좌표 변환
- **permission_handler 11.1.0**: 위치 권한 관리

### **지도 & 네비게이션**

- **google_maps_flutter 2.5.0**: Google Maps 연동
- **google_maps_flutter_web 0.5.12+2**: 웹용 지도
- **go_router 12.1.3**: 선언적 라우팅

### **인증 & 소셜 로그인**

- **google_sign_in 6.1.6**: Google 소셜 로그인
- **shared_preferences 2.2.2**: 로컬 데이터 저장

### **UI/UX 향상**

- **cached_network_image 3.3.0**: 이미지 캐싱 & 최적화
- **cupertino_icons 1.0.6**: iOS 스타일 아이콘

### **수익화 & 광고**

- **google_mobile_ads 4.0.0**: Google AdMob 연동

---

## 🔧 핵심 기능 구현

### **1. 위치 기반 검색**

```dart
// LocationProvider - 현재 위치 획득
Future<Position> getCurrentLocation() async {
  final permission = await Geolocator.checkPermission();
  if (permission == LocationPermission.denied) {
    await Geolocator.requestPermission();
  }
  return await Geolocator.getCurrentPosition(
    desiredAccuracy: LocationAccuracy.high
  );
}
```

### **2. 상태 관리 패턴**

```dart
// Provider 패턴 구현
class RestaurantProvider extends ChangeNotifier {
  List<Restaurant> _restaurants = [];
  FilterModel _currentFilter = FilterModel();

  void updateRestaurants(List<Restaurant> restaurants) {
    _restaurants = restaurants;
    notifyListeners(); // UI 자동 업데이트
  }
}
```

### **3. API 통신 구조**

```dart
// Dio를 활용한 HTTP 클라이언트
class RestaurantService {
  final Dio _dio = Dio();

  Future<List<Restaurant>> searchNearbyRestaurants({
    required double lat,
    required double lng,
    required int radius,
  }) async {
    final response = await _dio.get('/search/restaurant');
    return response.data.map((json) => Restaurant.fromJson(json)).toList();
  }
}
```

### **4. 테마 시스템**

```dart
// 라이트/다크 모드 지원
class AppTheme {
  static ThemeData lightTheme = ThemeData(
    primarySwatch: Colors.blue,
    brightness: Brightness.light,
  );

  static ThemeData darkTheme = ThemeData(
    primarySwatch: Colors.blue,
    brightness: Brightness.dark,
  );
}
```

---

## 🛡 보안 & 권한 관리

### **권한 처리**

- **위치 권한**: GPS 정확도별 권한 요청
- **네트워크 권한**: API 통신을 위한 인터넷 접근
- **저장소 권한**: 설정 및 캐시 데이터 저장

### **API 키 보안**

```dart
// .env 파일을 통한 API 키 관리
GOOGLE_MAPS_API_KEY=your_api_key_here
KAKAO_LOCAL_API_KEY=your_kakao_key_here
```

### **데이터 암호화**

- **SharedPreferences**: 민감하지 않은 설정 데이터
- **API 토큰**: 메모리 내에서만 관리

---

## 📱 플랫폼별 설정

### **Android 설정**

```xml
<!-- android/app/src/main/AndroidManifest.xml -->
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.INTERNET" />

<meta-data
    android:name="com.google.android.geo.API_KEY"
    android:value="${GOOGLE_MAPS_API_KEY}" />
```

### **iOS 설정**

```xml
<!-- ios/Runner/Info.plist -->
<key>NSLocationWhenInUseUsageDescription</key>
<string>이 앱은 근처 식당 찾기를 위해 위치 정보를 사용합니다.</string>
```

### **Web 설정**

```html
<!-- web/index.html -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
```

---

## ⚡ 성능 최적화

### **1. 메모리 관리**

- **이미지 캐싱**: `cached_network_image`로 네트워크 이미지 최적화
- **리스트 가상화**: 대용량 식당 목록 효율적 렌더링
- **상태 관리**: Provider를 통한 불필요한 리빌드 방지

### **2. 네트워크 최적화**

- **요청 캐싱**: Dio 인터셉터를 통한 중복 요청 방지
- **이미지 압축**: WebP 포맷 사용으로 대역폭 절약
- **지연 로딩**: 필요한 시점에만 데이터 로드

### **3. 앱 사이즈 최적화**

- **트리 쉐이킹**: 사용하지 않는 코드 자동 제거
- **애셋 최적화**: 해상도별 이미지 리소스 관리

---

## 🔄 데이터 플로우

### **1. 앱 시작 플로우**

```
Splash Screen → 권한 체크 → 위치 획득 → Main Screen
```

### **2. 식당 검색 플로우**

```
사용자 위치 → 필터 적용 → API 요청 → 결과 표시 → 상세 정보
```

### **3. 상태 관리 플로우**

```
User Action → Provider 업데이트 → notifyListeners() → UI 리빌드
```

---

## 🧪 테스팅 전략

### **단위 테스트**

- **모델 테스트**: 데이터 직렬화/역직렬화
- **서비스 테스트**: API 통신 로직
- **유틸리티 테스트**: 헬퍼 함수들

### **통합 테스트**

- **위젯 테스트**: UI 컴포넌트 상호작용
- **플로우 테스트**: 전체 사용자 여정

### **테스트 환경**

```dart
// test/ 디렉토리 구조
test/
├── unit/
│   ├── models/
│   ├── services/
│   └── utils/
├── widget/
└── integration/
```

---

## 🚀 배포 & CI/CD

### **빌드 설정**

```yaml
# pubspec.yaml - 버전 관리
version: 1.0.0+1
```

### **플랫폼별 빌드**

```bash
# Android
flutter build apk --release

# iOS
flutter build ios --release

# Web
flutter build web --release
```

---

## 📊 모니터링 & 분석

### **성능 모니터링**

- **Firebase Analytics**: 사용자 행동 분석
- **Crashlytics**: 실시간 충돌 리포트
- **Performance Monitoring**: 앱 성능 메트릭

### **사용자 피드백**

- **In-App Review**: 앱 내 리뷰 요청
- **버그 리포팅**: 사용자 피드백 수집

---

## 🔮 향후 기술 로드맵

### **Phase 1 (현재)**

- ✅ 기본 아키텍처 구축
- ✅ 위치 기반 검색 구현
- ✅ 다크/라이트 테마

### **Phase 2 (진행 중)**

- 🔄 실제 API 연동
- 🔄 Google Maps 완전 연동
- 🔄 소셜 로그인 완성

### **Phase 3 (계획)**

- 📋 실시간 알림 시스템
- 📋 오프라인 모드 지원
- 📋 AI 기반 추천 엔진

### **Phase 4 (확장)**

- 📋 백엔드 마이크로서비스 아키텍처
- 📋 GraphQL API 도입
- 📋 실시간 위치 공유

---

## ⚠️ 현재 기술적 이슈

### **해결된 이슈**

- ✅ iOS/Android 플랫폼 지원 추가 완료
- ✅ 웹 빌드 환경 설정 완료

### **진행 중인 이슈**

- 🔄 웹 디버그 모드 Chrome 연결 불안정
- 🔄 Google Maps API 키 설정 필요
- 🔄 소셜 로그인 SDK 연동 진행

### **예정된 개선사항**

- 📋 API 응답 시간 최적화
- 📋 메모리 사용량 프로파일링
- 📋 배터리 최적화

---

## 📈 성능 메트릭

### **목표 지표**

- **앱 시작 시간**: < 3초
- **검색 응답 시간**: < 2초
- **메모리 사용량**: < 100MB
- **배터리 사용량**: 최적화 필요

### **현재 상태**

- **코드 커버리지**: 기본 구조 완성
- **테스트 커버리지**: 구축 예정
- **성능 점수**: 측정 예정

---

# 📝 Summary (요약)

## 🎯 핵심 요약

**선장님 오늘의 메뉴는요?**는 Flutter 기반의 크로스 플랫폼 앱으로, 위치 기반 식당 추천 서비스를 제공합니다.

### **기술적 특징**

- **아키텍처**: MVVM + Provider 패턴
- **언어/프레임워크**: Dart 3.0+ / Flutter 3.10+
- **지원 플랫폼**: iOS, Android, Web

### **핵심 기능**

- 🗺️ **위치 기반 식당 검색**: GPS + Google Maps
- 🎲 **랜덤 선택**: 선택장애 해결
- 🔍 **스마트 필터링**: 음식 종류/메뉴 타입
- 🔐 **소셜 로그인**: Google, Naver, Kakao
- 🎨 **테마 시스템**: 라이트/다크 모드

### **주요 기술 스택**

```
Frontend: Flutter + Dart + Material Design
State: Provider + ChangeNotifier
Network: Dio + HTTP + flutter_dotenv
Location: geolocator + geocoding + permission_handler
Maps: google_maps_flutter + go_router
Auth: google_sign_in + shared_preferences
```

### **현재 개발 상태**

- ✅ **완료**: 기본 아키텍처, 테마 시스템, 플랫폼 지원
- 🔄 **진행 중**: Google Maps 연동, 실제 API 연동
- 📋 **예정**: 실시간 알림, AI 추천, 오프라인 모드

### **기술적 강점**

- **확장 가능한 아키텍처**: Provider 패턴으로 유지보수성 확보
- **크로스 플랫폼**: 하나의 코드베이스로 3개 플랫폼 지원
- **성능 최적화**: 이미지 캐싱, 상태 관리 최적화
- **보안**: API 키 분리, 권한 관리 체계화

이 프로젝트는 현대적인 Flutter 개발 best practices를 적용하여 구축된 실용적인 위치 기반 서비스입니다.
